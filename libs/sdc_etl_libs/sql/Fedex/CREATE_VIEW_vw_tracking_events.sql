CREATE OR REPLACE VIEW "LOGISTICS"."FEDEX"."VW_TRACKING_EVENTS" COPY GRANTS AS
(
SELECT
	"RTYPE",
	"CCODE",
	"TPIDC",
	"TRCKNUM",
	"FILL1",
	"MTRKNUM",
	"FILL2",
	"SHIPD",
	"ESTDD",
	"ESTDT",
	"DELVD",
	"DELVT",
	"PODNM",
	"OCODE",
	"DCODE",
	"STATD",
	"STATC",
	"FILL3",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPRN" ELSE sha2("SHPRN", 512) END AS "SHPRN",
	"SHPCO",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPA1" ELSE sha2("SHPA1", 512) END AS "SHPA1",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPA2" ELSE sha2("SHPA2", 512) END AS "SHPA2",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPA3" ELSE sha2("SHPA3", 512) END AS "SHPA3",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPRC" ELSE sha2("SHPRC", 512) END AS "SHPRC",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPRS" ELSE sha2("SHPRS", 512) END AS "SHPRS",
	CASE WHEN PII_ACCESS = TRUE THEN "SHPCC" ELSE sha2("SHPCC", 512) END AS "SHPCC",
	"SHPRZ",
	"ACCTNUM",
	"SIREF",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPTN" ELSE sha2("RCPTN", 512) END AS "RCPTN",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPCO" ELSE sha2("RCPCO", 512) END AS "RCPCO",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPA1" ELSE sha2("RCPA1", 512) END AS "RCPA1",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPA2" ELSE sha2("RCPA2", 512) END AS "RCPA2",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPA3" ELSE sha2("RCPA3", 512) END AS "RCPA3",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPTC" ELSE sha2("RCPTC", 512) END AS "RCPTC",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPTS" ELSE sha2("RCPTS", 512) END AS "RCPTS",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPTZ" ELSE sha2("RCPTZ", 512) END AS "RCPTZ",
	CASE WHEN PII_ACCESS = TRUE THEN "RCPCC" ELSE sha2("RCPCC", 512) END AS "RCPCC",
	"FILL4",
	"SVCCD",
	"PKGCD",
	"TRPAY",
	"DTPAY",
	"TYPCD",
	"FILL5",
	"PIECS",
	"UOMCD",
	"DIMCD",
	"FILL6",
	"PKGLN",
	"PKGWD",
	"PKGHT",
	"POREF",
	"INREF",
	"DEPTNUM",
	"SHPID",
	"LBWGT",
	"KGWGT",
	"DEXCD",
	"SCODE",
	"TCNNUM",
	"BOLNUM",
	"PCNUM1",
	"PCNUM2",
	"RMANUM",
	"APPTD",
	"APPTT",
	"ECITY",
	"EVEST",
	"EVECO",
	"CDRC1",
	"CDRC2",
	"AINFO",
	"SPHC1",
	"SPHC2",
	"SPHC3",
	"SPHC4",
	"RCPTNUM",
	"FILL7",
	"_ETL_FILENAME",
	"_SF_INSERTEDDATETIME"
 FROM "LOGISTICS"."FEDEX"."TRACKING_EVENTS"
 LEFT JOIN "DATAENG_UTILS"."MAPPINGS"."PII_MAPPINGS" PII ON PII.ROLE = CURRENT_ROLE()
);
