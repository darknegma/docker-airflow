CREATE VIEW "CONTACT_CENTER"."FIVE9"."VW_PHONE_CALL_DETAILS" AS
(
SELECT
	"CALL_ID",
	"SESSION_ID",
	CASE WHEN PII_ACCESS = TRUE THEN "ANI" ELSE sha2("ANI", 512) END AS "ANI",
	CASE WHEN PII_ACCESS = TRUE THEN "DNIS" ELSE sha2("DNIS", 512) END AS "DNIS",
	"DATE",
	"TIME",
	CASE WHEN PII_ACCESS = TRUE THEN "AGENT_EMAIL" ELSE sha2("AGENT_EMAIL", 512) END AS "AGENT_EMAIL",
	"AGENT_ID",
	CASE WHEN PII_ACCESS = TRUE THEN "AGENT" ELSE sha2("AGENT", 512) END AS "AGENT",
	"ABANDONED",
	"CAMPAIGN",
	"CAMPAIGN_TYPE",
	"SKILL",
	"CALLS_TIMED_OUT_IN_IVR",
	"CONSULT_TIME",
	"HOLD_TIME",
	"IVR_TIME",
	"BILL_TIME_ROUNDED",
	"CALL_TIME",
	"MANUAL_TIME",
	"RING_TIME",
	"TOTAL_QUEUE_TIME",
	"TIME_TO_ABANDON",
	"PREVIEW_TIME",
	"QUEUE_WAIT_TIME",
	"HANDLE_TIME",
	"AFTER_CALL_WORK_TIME",
	"PARK_TIME",
	"TALK_TIME",
	"CONFERENCE_TIME",
	"DIAL_TIME",
	"_3RD_PARTY_TALK_TIME",
	"TALK_TIME_LESS_HOLD_AND_PARK",
	"QUEUE_CALLBACK_WAIT_TIME",
	"SPEED_OF_ANSWER",
	"SERVICE_LEVEL",
	"DISPOSITION_GROUP_A",
	"DISPOSITION",
	"DISPOSITION_GROUP_B",
	"DISPOSITION_GROUP_C",
	CASE WHEN PII_ACCESS = TRUE THEN "CUSTOMER_NAME" ELSE sha2("CUSTOMER_NAME", 512) END AS "CUSTOMER_NAME",
	"NOTES",
	"QUEUE_CALLBACK_PROCESSING",
	"QUEUE_CALLBACK_REGISTERED",
	"TRANSFERS",
	"AGENT_GROUP",
	"VOICEMAILS",
	"VOICEMAILS_HANDLED",
	"VOICEMAILS_RETURNED_CALL",
	"VOICEMAILS_HANDLE_TIME",
	"VOICEMAILS_TRANSFERRED",
	"VOICEMAILS_DELETED",
	"VOICEMAILS_DECLINED",
	"APPOINTMENT_DATE",
	"APPOINTMENT_STATUS",
	"APPOINTMENT_TIME",
	"ATTEMPTS",
	"CALL_PREF_REASON",
	"CALL_PREFERENCE",
	"CASE_PRIORITY_NOTES",
	"CASE_STATUS",
	"CASE_STATUS_AGING",
	"CASENUMBER",
	"CITY",
	"COMPANY",
	"CONTACT_CREATE_TIMESTAMP",
	"CONTACT_ID",
	"CONTACT_MODIFIED_TIMESTAMP",
	"COUNTRY_ID",
	"CREATED_DATE",
	"CREATEDATE",
	"CURRENT_CASE_STATUS_DATE",
	"CURRENT_PREAUTH_TYPE",
	"CURRENT_PRESCRIPTION_KIND",
	"CURRENT_RETAINER_PREAUTH",
	"DAYS_OVERDUE",
	"DAYS_REMAINING_BEFORE_END_OF_TREAMENT",
	"DISCOUNT_CODE",
	CASE WHEN PII_ACCESS = TRUE THEN "EMAIL" ELSE sha2("EMAIL", 512) END AS "EMAIL",
	"END_DATE_OF_TREAMENT_DATE",
	CASE WHEN PII_ACCESS = TRUE THEN "FIRST_NAME" ELSE sha2("FIRST_NAME", 512) END AS "FIRST_NAME",
	"LAST_ALIGNER_PRODUCT_TYPE",
	"LAST_MCC_REF_REQUEST_STATUS",
	CASE WHEN PII_ACCESS = TRUE THEN "LAST_NAME" ELSE sha2("LAST_NAME", 512) END AS "LAST_NAME",
	"LEAD_SCORE",
	"LEAD_SCORE_CATEGORY",
	"NINETY_DAYS_DATE_INTO_TREATMENT_DATE",
	CASE WHEN PII_ACCESS = TRUE THEN "NUMBER1" ELSE sha2("NUMBER1", 512) END AS "NUMBER1",
	CASE WHEN PII_ACCESS = TRUE THEN "NUMBER2" ELSE sha2("NUMBER2", 512) END AS "NUMBER2",
	CASE WHEN PII_ACCESS = TRUE THEN "NUMBER3" ELSE sha2("NUMBER3", 512) END AS "NUMBER3",
	"ORDER_CHANNEL",
	"CHEIF_CONCERN",
	"OVERDUE_DATE",
	"LAST_CASE_NOTE",
	"RANDOM_NUMBER",
	"CX_LEAD_CATEGORY",
	"SCAN_OR_IK",
	"CARD_ON_FILE",
	"STATE",
	"STORE",
	"STREET",
	"TREATMENT_START_DATE",
	"ZIP",
	"ANI_STATE",
	"ANI_AREA_CODE",
	"DNIS_STATE",
	"CALLS_COMPLETED_IN_IVR",
	"ABANDON_RATE",
	"ANI_COUNTRY",
	"ANI_COUNTRY_CODE",
	"CALL_SURVEY_RESULT",
	"CALL_TYPE",
	"CALLS",
	"CONTACTED",
	"DISCONNECTED_FROM_HOLD",
	"DISPOSITION_PATH",
	"DNIS_AREA_CODE",
	"DNIS_COUNTRY",
	"DNIS_COUNTRY_CODE",
	"IVR_PATH",
	"LIST_NAME",
	"LIVE_CONNECT",
	"NO_PARTY_CONTACT",
	"PARENT_SESSION_ID",
	"RECORDINGS",
	"IVR_COST",
	"COST",
	"CONFERENCES",
	"HOLDS",
	"IVR_RATE",
	"PARKS",
	"PREVIEW_INTERRUPTED",
	"PREVIEW_INTERRUPTED_BY_CALL",
	"PREVIEW_INTERRUPTED_BY_SKILL_VM",
	"RATE",
	"VIDEO_TIME",
	"CUSTOMER_FACTS",
	"_ETL_FILENAME"
 FROM "CONTACT_CENTER"."FIVE9"."PHONE_CALL_DETAILS"
 LEFT JOIN "DATAENG_UTILS"."MAPPINGS"."PII_MAPPINGS" PII ON PII.ROLE = CURRENT_ROLE()
);